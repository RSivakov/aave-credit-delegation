query main($productIds: [String]!, $managerIds: [String]!, $owner: String!) {
  markets(where: { productId_in: $productIds }) {
    id
    marketId
    title
    author
    aggregatedPools {
      id
      poolList
    }
    productId
    product {
      id
      title
    }
    desiredCover
    capitalToken
    premiumToken
  }

  pools(where: { manager_in: $managerIds }) {
    id
    name
    capitalTokenSymbol
    capitalTokenAddress
    capitalTokenDecimals
    manager
    markets {
      id
      title
      product {
        id
        title
      }
    }
  }

  loans: policies(where: { productId_in: $productIds }) {
    id
    productId
    marketId
    policyId
    owner
    balance
    coverage
    premiumDeposit
    totalCharged
    underlyingCover
    validFrom
    validUntil
    market {
      id
      aggregatedPools {
        id
        poolList
      }
    }
  }

  myLoans: policies(where: { productId_in: $productIds, owner: $owner }) {
    id
    productId
    marketId
    policyId
    owner
    balance
    coverage
    premiumDeposit
    totalCharged
    underlyingCover
    validFrom
    validUntil
    market {
      id
      aggregatedPools {
        id
        poolList
      }
    }
  }
}
